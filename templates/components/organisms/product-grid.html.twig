{#
  Product Grid organism component
  
  Props:
  - products: array of product objects
  - columns: number of columns (default: 3)
#}

{% set columns = columns|default(3) %}
{% set col_class = 'col-lg-' ~ (12 // columns) ~ ' col-md-6 col-sm-12' %}

<div class="product-grid">
	<div class="row g-4">
		{% for product in products %}
			<div class="{{ col_class }}">
				{% set card_content %}
				<h5 class="card-title">{{ product.marque }}
					{{ product.modele }}</h5>
				<p class="card-text text-muted mb-2">
					{% include 'components/atoms/badge.html.twig' with {
              type: 'secondary',
              content: product.type
            } %}
					{% include 'components/atoms/badge.html.twig' with {
              type: 'info',
              content: product.genre
            } %}
					{% include 'components/atoms/badge.html.twig' with {
              type: 'warning',
              content: 'Taille ' ~ product.taille
            } %}
				</p>

				<p class="card-text">{{ product.description|slice(0, 100) }}...</p>

				<div class="mt-auto">
					{% include 'components/molecules/price-display.html.twig' with {
              price: product.prix,
              sale_price: product.estEnPromotion ? product.prixPromotion : null
            } %}

					<div class="d-flex justify-content-between align-items-center mt-3">
						<small class="text-muted">Stock:
							{{ product.stock }}</small>

						<div class="btn-group" role="group">
							{% include 'components/atoms/button.html.twig' with {
                  content: 'Voir',
                  type: 'outline',
                  size: 'sm',
                  tag: 'a',
                  href: path('app_velo_show', {id: product.id})
                } %}

							{% include 'components/atoms/button.html.twig' with {
                  content: '<svg width="16" height="16" fill="currentColor"><use href="#cart-plus"></use></svg>',
                  type: 'primary',
                  size: 'sm',
                  attributes: 'data-product-id="' ~ product.id ~ '"'
                } %}
						</div>
					</div>
				</div>
				{% endset %}

				{% include 'components/molecules/card.html.twig' with {
          image: product.imageUrl,
          image_alt: product.marque ~ ' ' ~ product.modele,
          content: card_content
        } %}
			</div>
		{% else %}
			<div class="col-12">
				<div class="text-center py-5">
					<svg width="64" height="64" fill="currentColor" class="text-muted mb-3">
						<use href="#bicycle"></use>
					</svg>
					<h4 class="text-muted">Aucun vélo trouvé</h4>
					<p class="text-muted">Essayez de modifier vos critères de recherche.</p>
				</div>
			</div>
		{% endfor %}
	</div>
</div>
